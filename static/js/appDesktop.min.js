function armoSelectAnomalias(a){for(var b=0;b<a.causas.length;b++)$("#causa_frm").append('<option value="'+a.causas[b].id+'">'+a.causas[b].descripcion+"</option>")}function actualizoRegistro(){var a=$("#comentario_frm").val();void 0===a&&(a=""),console.log(">",a);var b="anomaly_id="+$("#anomaly_frm").val()+"&comentario="+a+"&causa_id="+$("#causa_frm").val()+"&tipo_corte="+$("#corte_frm").val();$.ajax({type:"POST",url:"/index",data:b,success:function(a){"guardado"===a?console.log("guardado con éxito"):console.log("Error: ",a)},contentType:"application/x-www-form-urlencoded"})}function abreDetalleCorredor(a){$(".corredorActivo").removeClass("corredorActivo"),$("#"+a[0].id).addClass("corredorActivo"),$("#cuadroOperador").fadeOut(0);var b=a.find(".titulo");$("#corredores .titulo")[0].innerHTML=b[0].innerHTML,llenaPantallaActualizacion(b.parent()[0].id),$("#cuadroOperador").fadeIn("fast")}function llenaPantallaActualizacion(a){var b=0,c="",d=[0,0],e="",f="";$("#corredores .etiquetasCapital").html(""),$("#corredores .etiquetasProvincia").html(""),$("#corredores #corredorCapital").html(""),$("#corredores #corredorProvincia").html(""),$("#avisoProvincia").html(""),$("#avisoCapital").html(""),$("#corredores .corredoresCapital").html(""),$("#corredores .corredoresProvincia").html(""),$("#panelesProvincia").html(""),$("#panelesCapital").html(""),"undefined"!=typeof corredores[a].provincia&&(b=corredores[a].provincia.length,c=corredores[a].provincia,e=corredores[a].provincia,d[1]=1),"undefined"!=typeof corredores[a].capital&&(b=corredores[a].capital.length,c=corredores[a].capital,f=corredores[a].capital,d[0]=1);for(var g=0;g<c.length;g++){var h="cen";0===g&&(h="izq"),$("#corredores .etiquetasCapital").append('<div class="nombreCorredor '+h+'">'+nombresDeCorredores[c[g]].nombreSegmento.split(" - ")[0]+"</div>"),$("#corredores .etiquetasProvincia").append('<div class="nombreCorredor '+h+'">'+nombresDeCorredores[c[g]].nombreSegmento.split(" - ")[0]+"</div>")}$("#corredores .etiquetasCapital").append('<div class="nombreCorredor der">'+nombresDeCorredores[c[c.length-1]].nombreSegmento.split(" - ")[1]+"</div>"),$("#corredores .etiquetasProvincia").append('<div class="nombreCorredor der">'+nombresDeCorredores[c[c.length-1]].nombreSegmento.split(" - ")[1]+"</div>"),0===d[1]&&$("#avisoProvincia").append('<div id="aviso">El trayecto no tiene dirección hacia Provincia</div>'),0===d[0]&&$("#avisoCapital").append('<div id="aviso">El trayecto no tiene dirección hacia Capital</div>');for(var g=0;g<c.length;g++)0===d[0]?$("#corredores .corredoresCapital").append('<div class="corredor segmento estado0"></div>'):($("#corredores .corredoresCapital").append('<div class="corredor segmento estado'+nombresDeCorredores[f[g]].anomalia+'"></div>'),$("#panelesCapital").append('<div class="panel" id="c'+f[g]+'"><div class="filaPanel">Aviso de anomalia<div class="datoPanel">'+nombresDeCorredores[f[g]].duracion_anomalia+'´</div></div><div class="filaPanel">Tiempo del trayecto<div class="datoPanel">'+nombresDeCorredores[f[g]].tiempo+'´</div></div><div class="filaPanel">Demora<div class="datoPanel">'+(100*nombresDeCorredores[f[g]].indicador_anomalia).toFixed(1)+'% </div></div><div class="filaPanel">Causa<div class="datoPanel">'+nombresDeCorredores[f[g]].causa+"</div></div></div>")),0===d[1]?$("#corredores .corredoresProvincia").append('<div class="corredor segmento estado0"> </div>'):($("#corredores .corredoresProvincia").append('<div class="corredor segmento estado'+nombresDeCorredores[e[g]].anomalia+' "></div>'),$("#panelesProvincia").append('<div class="panel" id="c'+e[g]+'"><div class="filaPanel">Aviso de anomalia<div class="datoPanel">'+nombresDeCorredores[e[g]].duracion_anomalia+'´</div></div><div class="filaPanel">Tiempo del trayecto<div class="datoPanel">'+nombresDeCorredores[e[g]].tiempo+'´</div></div><div class="filaPanel">Demora<div class="datoPanel">'+(100*nombresDeCorredores[e[g]].indicador_anomalia).toFixed(1)+'% </div></div><div class="filaPanel">Causa<div class="datoPanel">'+nombresDeCorredores[e[g]].causa+"</div></div></div>"));$(".panel").click(function(){llenoPantallaEdicion(this.id.replace("c","")),$("#seleccioneTrayecto").css("display","none")})}function llenoPantallaEdicion(a){$("#trayecto_frm").html(nombresDeCorredores[a].nombreSegmento),$("#sentido_frm").html(nombresDeCorredores[a].sentido),$("#anomalia_frm").html(nombresDeCorredores[a].duracion_anomalia),$("#tiempo_frm").html(nombresDeCorredores[a].tiempo+" min."),$("#demora_frm").html((100*nombresDeCorredores[a].indicador_anomalia).toFixed(1)+"%"),0!=nombresDeCorredores[a].anomalia_id?($("#oculta").css("display","none"),$("anomaly_frm").val(nombresDeCorredores[a].anomalia_id),$("#corte_frm").val("1"),$("#causa_frm").val("4"),$("#descripcion_frm").val("")):$("#oculta").css("display","inline")}function actualizacionDesktop(a){var b=[],c=[],d="",e=-1,f=!1,g=!1;if($("#"+a.id+" .titulo").html(a.nombre),$("#"+a.id).removeClass("cargando"),0!=a.segmentos_capital.length){console.log(a.segmentos_capital);for(var h=0;h<a.segmentos_capital.length;h++)e<a.segmentos_capital[h].anomalia&&(e=a.segmentos_capital[h].anomalia,0==a.segmentos_capital[h].causa_id&&(f=!0,g||0==a.segmentos_capital[h].causa_id||(g=!0))),nombresDeCorredores[a.segmentos_capital[h].id].sentido="capital",nombresDeCorredores[a.segmentos_capital[h].id].anomalia=a.segmentos_capital[h].anomalia,nombresDeCorredores[a.segmentos_capital[h].id].anomalia_id=a.segmentos_capital[h].anomalia_id,nombresDeCorredores[a.segmentos_capital[h].id].causa=a.segmentos_capital[h].causa,nombresDeCorredores[a.segmentos_capital[h].id].causa_id=a.segmentos_capital[h].causa_id,nombresDeCorredores[a.segmentos_capital[h].id].duracion_anomalia=a.segmentos_capital[h].duracion_anomalia,nombresDeCorredores[a.segmentos_capital[h].id].id=a.segmentos_capital[h].id,nombresDeCorredores[a.segmentos_capital[h].id].indicador_anomalia=a.segmentos_capital[h].indicador_anomalia,nombresDeCorredores[a.segmentos_capital[h].id].tiempo=a.segmentos_capital[h].tiempo,nombresDeCorredores[a.segmentos_capital[h].id].velocidad=a.segmentos_capital[h].velocidad,b.push(a.segmentos_capital[h].id);d='"capital":['+b.toString()+"]"}if(0!=a.segmentos_provincia.length){for(var i=0;i<a.segmentos_provincia.length;i++)e<a.segmentos_provincia[i].anomalia&&(e=a.segmentos_provincia[i].anomalia,0==a.segmentos_provincia[i].causa_id&&(f=!0,g||0==a.segmentos_provincia[i].causa_id||(g=!0))),nombresDeCorredores[a.segmentos_provincia[i].id].sentido="provincia",nombresDeCorredores[a.segmentos_provincia[i].id].anomalia=a.segmentos_provincia[i].anomalia,nombresDeCorredores[a.segmentos_provincia[i].id].anomalia_id=a.segmentos_provincia[i].anomalia_id,nombresDeCorredores[a.segmentos_provincia[i].id].causa=a.segmentos_provincia[i].causa,nombresDeCorredores[a.segmentos_provincia[i].id].causa_id=a.segmentos_provincia[i].causa_id,nombresDeCorredores[a.segmentos_provincia[i].id].duracion_anomalia=a.segmentos_provincia[i].duracion_anomalia,nombresDeCorredores[a.segmentos_provincia[i].id].id=a.segmentos_provincia[i].id,nombresDeCorredores[a.segmentos_provincia[i].id].indicador_anomalia=a.segmentos_provincia[i].indicador_anomalia,nombresDeCorredores[a.segmentos_provincia[i].id].tiempo=a.segmentos_provincia[i].tiempo,nombresDeCorredores[a.segmentos_provincia[i].id].velocidad=a.segmentos_provincia[i].velocidad,c.push(a.segmentos_provincia[i].id);d=""!=d?d+',"provincia":['+c.toString()+"]":'"provincia":['+c.toString()+"]"}$("#"+a.id).addClass("borde"+e);var j=$("#"+a.id+" .icono");j.removeClass(),j.addClass("icono"),f?j.addClass("iconoAzul"):g?j.addClass("iconoGris"):j.addClass("iconoRojo");var k=JSON.parse("{"+d+"}");corredores[a.id]=k}var corredores=JSON.parse("{}"),nombresDeCorredores=function(){var a=null;return $.ajax({async:!1,global:!1,url:"_static/data/segmentos.json",dataType:"json",success:function(b){a=b}}),a}(),causasAnomalias=function(){var a=null;return $.ajax({async:!1,global:!1,url:"_static/data/causas.json",dataType:"json",success:function(b){a=b,armoSelectAnomalias(b)}}),a}();$("#logo").click(function(){$("#mapa").animate({height:"100%"},200)}),$(".corredor").click(function(){$("#seleccioneTrayecto").css("display","inline"),$("#oculta").css("display","none");var a=$(this);$(this).hasClass("cargando")===!1?$("#mapa").animate({height:"300px"},200):$("#mapa").animate({height:"100%"},200),$(this).hasClass("cargando")===!1&&abreDetalleCorredor(a)});