function armoSelectAnomalias(a){for(var b=0;b<a.causas.length;b++)$("#causa_frm").append('<option value="'+a.causas[b].id+'">'+a.causas[b].descripcion+"</option>")}function actualizoRegistro(){var a="anomaly_id="+$("#anomaly_frm").val()+"&comentario="+$("#comentario_frm").val()+"&causa_id="+$("#causa_frm").val();$.ajax({type:"POST",url:"/index",data:a,success:function(a){"guardado"===a?console.log("guardado con éxito"):console.log("Error: ",a)},contentType:"application/x-www-form-urlencoded"})}function abreDetalleCorredor(a){$("#cuadroOperador").fadeOut(0);var b=a.find(".titulo");$("#corredores .titulo")[0].innerHTML=b[0].innerHTML,llenaPantallaActualizacion(b.parent()[0].id),$("#cuadroOperador").fadeIn("fast")}function llenaPantallaActualizacion(a){var b=0,c="",d=[0,0],e="",f="";$("#corredores .etiquetasCapital").html(""),$("#corredores .etiquetasProvincia").html(""),$("#corredores #corredorCapital").html(""),$("#corredores #corredorProvincia").html(""),$("#avisoProvincia").html(""),$("#avisoCapital").html(""),$("#corredores .corredoresCapital").html(""),$("#corredores .corredoresProvincia").html(""),$("#panelesProvincia").html(""),$("#panelesCapital").html(""),"undefined"!=typeof corredores[a].provincia&&(b=corredores[a].provincia.length,c=corredores[a].provincia,e=corredores[a].provincia,d[1]=1),"undefined"!=typeof corredores[a].capital&&(b=corredores[a].capital.length,c=corredores[a].capital,f=corredores[a].capital,d[0]=1);for(var g=0;g<c.length;g++){var h="cen";0===g&&(h="izq"),$("#corredores .etiquetasCapital").append('<div class="nombreCorredor '+h+'">'+nombresDeCorredores[c[g]].nombreSegmento.split(" - ")[0]+"</div>"),$("#corredores .etiquetasProvincia").append('<div class="nombreCorredor '+h+'">'+nombresDeCorredores[c[g]].nombreSegmento.split(" - ")[0]+"</div>")}$("#corredores .etiquetasCapital").append('<div class="nombreCorredor der">'+nombresDeCorredores[c[c.length-1]].nombreSegmento.split(" - ")[1]+"</div>"),$("#corredores .etiquetasProvincia").append('<div class="nombreCorredor der">'+nombresDeCorredores[c[c.length-1]].nombreSegmento.split(" - ")[1]+"</div>"),0===d[1]&&$("#avisoProvincia").append('<div id="aviso">El trayecto no tiene dirección hacia Provincia</div>'),0===d[0]&&$("#avisoCapital").append('<div id="aviso">El trayecto no tiene dirección hacia Capital</div>');for(var g=0;g<c.length;g++)0===d[0]?$("#corredores .corredoresCapital").append('<div class="corredor segmento estado0"></div>'):($("#corredores .corredoresCapital").append('<div class="corredor segmento estado'+nombresDeCorredores[f[g]].anomalia+'"></div>'),$("#panelesCapital").append('<div class="panel" id="c'+f[g]+'"><div class="filaPanel">Aviso de anomalia<div class="datoPanel">Hace '+nombresDeCorredores[f[g]].duracion_anomalia+' min.</div></div><div class="filaPanel">Tiempo del trayecto<div class="datoPanel">'+nombresDeCorredores[f[g]].tiempo+'</div></div><div class="filaPanel">Demora<div class="datoPanel">'+(100*nombresDeCorredores[f[g]].indicador_anomalia).toFixed(1)+' </div></div><div class="filaPanel">Causa<div class="datoPanel">'+nombresDeCorredores[f[g]].causa+"</div></div></div>")),0===d[1]?$("#corredores .corredoresProvincia").append('<div class="corredor segmento estado0"> </div>'):($("#corredores .corredoresProvincia").append('<div class="corredor segmento estado'+nombresDeCorredores[e[g]].anomalia+' "></div>'),$("#panelesProvincia").append('<div class="panel" id="c'+e[g]+'"><div class="filaPanel">Aviso de anomalia<div class="datoPanel"> Hace '+nombresDeCorredores[e[g]].duracion_anomalia+' min.</div></div><div class="filaPanel">Tiempo del trayecto<div class="datoPanel">'+nombresDeCorredores[e[g]].tiempo+'</div></div><div class="filaPanel">Demora<div class="datoPanel">'+(100*nombresDeCorredores[e[g]].indicador_anomalia).toFixed(1)+' </div></div><div class="filaPanel">Causa<div class="datoPanel">'+nombresDeCorredores[e[g]].causa+"</div></div></div>"));$(".panel").click(function(){llenoPantallaEdicion(this.id.replace("c","")),$("#seleccioneTrayecto").css("display","none")})}function llenoPantallaEdicion(a){$("#trayecto_frm").html(nombresDeCorredores[a].nombreSegmento),$("#sentido_frm").html(nombresDeCorredores[a].sentido),$("#anomalia_frm").html(nombresDeCorredores[a].duracion_anomalia),$("#tiempo_frm").html(nombresDeCorredores[a].tiempo+" min."),$("#demora_frm").html((100*nombresDeCorredores[a].indicador_anomalia).toFixed(1)+"%"),0!=nombresDeCorredores[a].anomalia_id?($("#oculta").css("display","none"),$("#corte_frm").val("1"),$("#causa_frm").val("4"),$("#descripcion_frm").val("")):$("#oculta").css("display","inline")}function actualizacionDesktop(a){var b=[],c=[],d="";if($("#"+a.id+" .titulo").html(a.nombre),$("#"+a.id).removeClass("cargando"),0!=a.segmentos_capital.length){console.log(a.segmentos_capital);for(var e=0;e<a.segmentos_capital.length;e++)nombresDeCorredores[a.segmentos_capital[e].id].sentido="capital",nombresDeCorredores[a.segmentos_capital[e].id].anomalia=a.segmentos_capital[e].anomalia,nombresDeCorredores[a.segmentos_capital[e].id].anomalia_id=a.segmentos_capital[e].anomalia_id,nombresDeCorredores[a.segmentos_capital[e].id].causa=a.segmentos_capital[e].causa,nombresDeCorredores[a.segmentos_capital[e].id].causa_id=a.segmentos_capital[e].causa_id,nombresDeCorredores[a.segmentos_capital[e].id].duracion_anomalia=a.segmentos_capital[e].duracion_anomalia,nombresDeCorredores[a.segmentos_capital[e].id].id=a.segmentos_capital[e].id,nombresDeCorredores[a.segmentos_capital[e].id].indicador_anomalia=a.segmentos_capital[e].indicador_anomalia,nombresDeCorredores[a.segmentos_capital[e].id].tiempo=a.segmentos_capital[e].tiempo,nombresDeCorredores[a.segmentos_capital[e].id].velocidad=a.segmentos_capital[e].velocidad,b.push(a.segmentos_capital[e].id);d='"capital":['+b.toString()+"]"}if(0!=a.segmentos_provincia.length){for(var f=0;f<a.segmentos_provincia.length;f++)nombresDeCorredores[a.segmentos_provincia[f].id].sentido="provincia",nombresDeCorredores[a.segmentos_provincia[f].id].anomalia=a.segmentos_provincia[f].anomalia,nombresDeCorredores[a.segmentos_provincia[f].id].anomalia_id=a.segmentos_provincia[f].anomalia_id,nombresDeCorredores[a.segmentos_provincia[f].id].causa=a.segmentos_provincia[f].causa,nombresDeCorredores[a.segmentos_provincia[f].id].causa_id=a.segmentos_provincia[f].causa_id,nombresDeCorredores[a.segmentos_provincia[f].id].duracion_anomalia=a.segmentos_provincia[f].duracion_anomalia,nombresDeCorredores[a.segmentos_provincia[f].id].id=a.segmentos_provincia[f].id,nombresDeCorredores[a.segmentos_provincia[f].id].indicador_anomalia=a.segmentos_provincia[f].indicador_anomalia,nombresDeCorredores[a.segmentos_provincia[f].id].tiempo=a.segmentos_provincia[f].tiempo,nombresDeCorredores[a.segmentos_provincia[f].id].velocidad=a.segmentos_provincia[f].velocidad,c.push(a.segmentos_provincia[f].id);d=""!=d?d+',"provincia":['+c.toString()+"]":'"provincia":['+c.toString()+"]"}var g=JSON.parse("{"+d+"}");corredores[a.id]=g}var corredores=JSON.parse("{}"),nombresDeCorredores=function(){var a=null;return $.ajax({async:!1,global:!1,url:"_static/data/segmentos.json",dataType:"json",success:function(b){a=b}}),a}(),causasAnomalias=function(){var a=null;return $.ajax({async:!1,global:!1,url:"_static/data/causas.json",dataType:"json",success:function(b){a=b,armoSelectAnomalias(b)}}),a}();$("#logo").click(function(){$("#mapa").animate({height:"100%"},200)}),$(".corredor").click(function(){$("#seleccioneTrayecto").css("display","inline"),$("#oculta").css("display","none");var a=$(this);$(this).hasClass("cargando")===!1?$("#mapa").animate({height:"300px"},200):$("#mapa").animate({height:"100%"},200),$(this).hasClass("cargando")===!1&&abreDetalleCorredor(a)});